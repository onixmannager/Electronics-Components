<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Electronics Components</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script type="importmap">
    {
      "imports": {
        "vue": "https://unpkg.com/vue@3/dist/vue.esm-browser.js"
      }
    }
  </script>
  <style>
    :root {
      --primary-color: #e74c3c;
      --secondary-color: #f39c12;
      --dark-color: #2c3e50;
      --light-color: #ecf0f1;
      --text-color: #333;
      --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      --border-radius: 8px;
    }
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    body {
      background-color: #f5f5f5;
      color: var(--text-color);
    }
    #app {
      position: relative;
      min-height: 100vh;
    }
    /* Header */
    header {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      align-items: center;
      padding: 1rem;
      background-color: white;
      box-shadow: var(--shadow);
      position: sticky;
      top: 0;
      z-index: 10;
    }
    .logo {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .logo h1 {
      font-size: 1.2rem;
      color: var(--primary-color);
    }
    .search-bar {
      flex: 1;
      margin: 10px 20px;
    }
    .search-bar input {
      width: 100%;
      padding: 8px 12px;
      border: 1px solid #ddd;
      border-radius: var(--border-radius);
    }
    .cart-icon {
      position: relative;
      font-size: 1.5rem;
      color: var(--dark-color);
      cursor: pointer;
    }
    .cart-count {
      position: absolute;
      top: -8px;
      right: -8px;
      background-color: var(--primary-color);
      color: white;
      font-size: 0.7rem;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    /* Main content */
    main {
      padding: 1rem;
      max-width: 1200px;
      margin: 0 auto;
    }
    /* Categorías */
    .categories {
      display: flex;
      overflow-x: auto;
      gap: 10px;
      padding-bottom: 10px;
      margin-bottom: 10px;
    }
    .categories button {
      background-color: white;
      border: none;
      border-radius: var(--border-radius);
      padding: 10px 15px;
      white-space: nowrap;
      cursor: pointer;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 5px;
    }
    .categories button.active {
      background-color: var(--primary-color);
      color: white;
    }
    .categories button i {
      font-size: 1rem;
    }
    /* Subcategorías */
    .subcategories {
      display: flex;
      overflow-x: auto;
      gap: 10px;
      padding-bottom: 10px;
      margin-bottom: 20px;
    }
    .subcategories button {
      background-color: white;
      border: none;
      border-radius: var(--border-radius);
      padding: 8px 12px;
      white-space: nowrap;
      cursor: pointer;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      transition: all 0.3s ease;
    }
    .subcategories button.active {
      background-color: var(--primary-color);
      color: white;
    }
    /* Productos */
    .products {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 20px;
    }
    .product-card {
      background-color: white;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
      overflow: hidden;
      cursor: pointer;
      transition: transform 0.3s ease;
      display: flex;
      flex-direction: column;
    }
    .product-card:hover {
      transform: translateY(-5px);
    }
    .product-img {
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
      background-color: #f9f9f9;
    }
    .product-info {
      padding: 15px;
    }
    .product-info h3 {
      margin-bottom: 8px;
      color: var(--dark-color);
    }
    .description {
      color: #777;
      font-size: 0.9rem;
      margin-bottom: 10px;
    }
    .price {
      font-weight: bold;
      color: var(--primary-color);
      font-size: 1.1rem;
    }
    /* Modal (para detalle de producto) */
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 100;
    }
    .modal-content {
      background-color: white;
      border-radius: var(--border-radius);
      width: 90%;
      max-width: 600px;
      max-height: 90vh;
      overflow-y: auto;
      position: relative;
      padding-bottom: 20px;
    }
    .close-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      color: #777;
    }
    .modal-product {
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
    }
    .product-img.large {
      margin-bottom: 20px;
    }
    .size-selection {
      margin: 15px 0;
      text-align: left;
      width: 100%;
      padding: 0 20px;
    }
    .size-selection label {
      margin-right: 10px;
      font-weight: bold;
    }
    .size-selection select {
      padding: 6px 10px;
      border: 1px solid #ddd;
      border-radius: var(--border-radius);
    }
    .quantity-control {
      display: flex;
      align-items: center;
      margin: 20px 0;
    }
    .quantity-control button {
      width: 40px;
      height: 40px;
      background-color: #f5f5f5;
      border: none;
      border-radius: 50%;
      font-size: 1.2rem;
      cursor: pointer;
    }
    .quantity-control span {
      margin: 0 15px;
      font-size: 1.2rem;
      font-weight: bold;
    }
    .add-to-cart {
      background-color: var(--primary-color);
      color: white;
      border: none;
      border-radius: var(--border-radius);
      padding: 12px 20px;
      font-size: 1rem;
      cursor: pointer;
      width: 100%;
      transition: background-color 0.3s;
    }
    .add-to-cart:hover {
      background-color: #c0392b;
    }
    /* Cart Panel */
    .cart-panel {
      position: fixed;
      top: 0;
      right: -100%;
      width: 90%;
      max-width: 400px;
      height: 100%;
      background-color: white;
      box-shadow: -2px 0 5px rgba(0, 0, 0, 0.1);
      z-index: 50;
      transition: right 0.3s ease;
      display: flex;
      flex-direction: column;
    }
    .cart-panel.open {
      right: 0;
    }
    .cart-header {
      padding: 20px;
      border-bottom: 1px solid #eee;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .cart-items {
      flex: 1;
      overflow-y: auto;
      padding: 15px;
    }
    .cart-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 0;
      border-bottom: 1px solid #eee;
    }
    .item-info h3 {
      font-size: 1rem;
      margin-bottom: 5px;
    }
    .item-actions {
      display: flex;
      align-items: center;
      gap: 15px;
    }
    .item-total {
      font-weight: bold;
    }
    .remove-btn {
      background: none;
      border: none;
      color: #999;
      cursor: pointer;
      font-size: 0.9rem;
    }
    .remove-btn:hover {
      color: var(--primary-color);
    }
    .cart-empty {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      color: #999;
      padding: 30px;
    }
    .cart-empty i {
      font-size: 4rem;
      margin-bottom: 20px;
    }
    .cart-summary {
      padding: 20px;
      background-color: #f9f9f9;
      border-top: 1px solid #eee;
    }
    .summary-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
    }
    .summary-row.total {
      font-weight: bold;
      font-size: 1.1rem;
      border-top: 1px solid #ddd;
      padding-top: 10px;
      margin-top: 10px;
    }
    .checkout-btn {
      background-color: var(--primary-color);
      color: white;
      border: none;
      padding: 15px;
      font-size: 1.1rem;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    .checkout-btn:hover {
      background-color: #c0392b;
    }
    .overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 40;
    }
    @media (max-width: 767px) {
      .products {
        grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
        gap: 15px;
      }
      .product-info h3 {
        font-size: 0.9rem;
      }
      .description {
        font-size: 0.8rem;
      }
      .categories button {
        padding: 8px 12px;
        font-size: 0.9rem;
      }
    }
    @media (max-width: 480px) {
      .logo h1 {
        font-size: 1rem;
      }
      .cart-panel {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <div id="app">
    <header>
      <div class="logo">
        <!-- Reemplaza este SVG por el logo de tu empresa si lo deseas -->
        <svg width="40" height="40" viewBox="0 0 40 40">
          <circle cx="20" cy="20" r="18" fill="#e74c3c"/>
          <path d="M12,20 C12,15 16,12 20,12 C24,12 28,15 28,20 L26,30 L14,30 L12,20 Z" fill="#fff"/>
          <circle cx="15" cy="18" r="1.5" fill="#e74c3c"/>
          <circle cx="25" cy="18" r="1.5" fill="#e74c3c"/>
        </svg>
        <h1>Electronics Components</h1>
      </div>
      <div class="search-bar">
        <input type="text" placeholder="Buscar productos..." v-model="searchQuery">
      </div>
      <div class="cart-icon" @click="toggleCart">
        <i class="fas fa-shopping-cart"></i>
        <span class="cart-count" v-if="cartItems.length > 0">{{ cartItems.length }}</span>
      </div>
    </header>
    
    <main>
      <!-- Categorías -->
      <div class="categories">
        <button 
          v-for="category in categories" 
          :key="category.id" 
          @click="selectCategory(category)"
          :class="{ active: selectedCategory.id === category.id }">
          <i :class="category.icon"></i>
          {{ category.name }}
        </button>
      </div>
      
      <!-- Subcategorías (solo si la categoría seleccionada tiene subcategorías) -->
      <div class="subcategories" v-if="selectedCategory.subcategories">
        <button 
          v-for="sub in selectedCategory.subcategories" 
          :key="sub.id" 
          @click="selectSubcategory(sub)"
          :class="{ active: selectedSubcategory && selectedSubcategory.id === sub.id }">
          {{ sub.name }}
        </button>
      </div>
      
      <!-- Productos: Si la categoría es "Inicio" se muestran todos los productos; de lo contrario, se filtran -->
      <div class="products">
        <div 
          v-for="product in filteredProducts" 
          :key="product.id" 
          class="product-card"
          @click="showProductDetails(product)">
          <div class="product-img">
            <img v-if="product.imgUrl" :src="product.imgUrl" :alt="product.name" width="100" height="100">
            <svg v-else :width="100" :height="100" viewBox="0 0 100 100">
              <circle :cx="50" :cy="50" :r="45" :fill="product.color" />
              <path :d="product.svgPath" fill="#fff" />
            </svg>
          </div>
          <div class="product-info">
            <h3>{{ product.name }}</h3>
            <p class="description">{{ product.description }}</p>
            <p class="price">{{ formatPrice(product.price) }}</p>
          </div>
        </div>
      </div>
    </main>
    
    <!-- Modal de detalle de producto -->
    <div class="modal" v-if="selectedProduct" @click.self="closeModal">
      <div class="modal-content">
        <button class="close-btn" @click="closeModal">&times;</button>
        <div class="modal-product">
          <div class="product-img large">
            <img v-if="selectedProduct.imgUrl" :src="selectedProduct.imgUrl" :alt="selectedProduct.name" width="150" height="150">
            <svg v-else :width="150" :height="150" viewBox="0 0 100 100">
              <circle :cx="50" :cy="50" :r="45" :fill="selectedProduct.color" />
              <path :d="selectedProduct.svgPath" fill="#fff" />
            </svg>
          </div>
          <h2>{{ selectedProduct.name }}</h2>
          <p class="description">{{ selectedProduct.description }}</p>
          <p class="price">{{ formatPrice(selectedProduct.price) }}</p>
          
          <!-- Menú de selección de talla (se muestra solo si el producto tiene tallas disponibles) -->
          <div class="size-selection" v-if="getSizeOptions(selectedProduct).length">
            <label for="sizeSelect">Talla:</label>
            <select id="sizeSelect" v-model="selectedSize">
              <option disabled value="">Seleccione talla</option>
              <option v-for="size in getSizeOptions(selectedProduct)" :key="size" :value="size">{{ size }}</option>
            </select>
          </div>
          
          <!-- Control de cantidad -->
          <div class="quantity-control">
            <button @click="decreaseQuantity">-</button>
            <span>{{ quantity }}</span>
            <button @click="increaseQuantity">+</button>
          </div>
          <button class="add-to-cart" @click="addToCart">
            Añadir al carrito - {{ formatPrice(selectedProduct.price * quantity) }}
          </button>
        </div>
      </div>
    </div>
    
    <!-- Panel del carrito -->
    <div class="cart-panel" :class="{ open: isCartOpen }">
      <div class="cart-header">
        <h2>Tu pedido</h2>
        <button class="close-btn" @click="toggleCart">&times;</button>
      </div>
      <div class="cart-items" v-if="cartItems.length > 0">
        <div v-for="(item, index) in cartItems" :key="index" class="cart-item">
          <div class="item-info">
            <h3>{{ item.product.name }}</h3>
            <p v-if="item.size">
              {{ item.quantity }} x {{ formatPrice(item.product.price) }} - Talla: {{ item.size }}
            </p>
            <p v-else>
              {{ item.quantity }} x {{ formatPrice(item.product.price) }}
            </p>
          </div>
          <div class="item-actions">
            <p class="item-total">{{ formatPrice(item.product.price * item.quantity) }}</p>
            <button class="remove-btn" @click="removeFromCart(index)">
              <i class="fas fa-trash"></i>
            </button>
          </div>
        </div>
      </div>
      <div class="cart-empty" v-else>
        <i class="fas fa-shopping-basket"></i>
        <p>Tu carrito está vacío</p>
      </div>
      <div class="cart-summary" v-if="cartItems.length > 0">
        <div class="summary-row">
          <span>Subtotal:</span>
          <span>{{ formatPrice(cartSubtotal) }}</span>
        </div>
        <div class="summary-row">
          <span>IVA (10%):</span>
          <span>{{ formatPrice(cartTax) }}</span>
        </div>
        <div class="summary-row total">
          <span>Total:</span>
          <span>{{ formatPrice(cartTotal) }}</span>
        </div>
      </div>
      <button class="checkout-btn" v-if="cartItems.length > 0" @click="checkout">
        Realizar pedido
      </button>
    </div>
    
    <!-- Overlay del carrito -->
    <div class="overlay" v-if="isCartOpen" @click="toggleCart"></div>
    
  </div>
  
  <script type="module">
    import { createApp, ref, computed, watch } from 'vue';
    createApp({
      setup() {
        // Categorías: "Inicio" muestra todos los productos
        const categories = ref([
          { id: 0, name: 'Inicio', icon: 'fas fa-home' },
          { id: 1, name: 'Ropa de Hombre', icon: 'fas fa-male', subcategories: [
              { id: 11, name: 'Camisas' },
              { id: 12, name: 'Pantalones' },
              { id: 13, name: 'Chaquetas' }
            ]
          },
          { id: 2, name: 'Ropa de Mujer', icon: 'fas fa-female', subcategories: [
              { id: 21, name: 'Vestidos' },
              { id: 22, name: 'Blusas' },
              { id: 23, name: 'Faldas' }
            ]
          },
          { id: 3, name: 'Calzado', icon: 'fas fa-shoe-prints', subcategories: [
              { id: 31, name: 'Deportivos' },
              { id: 32, name: 'Elegantes' }
            ]
          },
          { id: 4, name: 'Accesorios', icon: 'fas fa-gem', subcategories: [
              { id: 41, name: 'Bolsos' },
              { id: 42, name: 'Joyería' },
              { id: 43, name: 'Sombreros' }
            ]
          }
        ]);
        // Productos (con propiedad imgUrl agregada)
        const products = ref([
          { 
            id: 1,
            name: 'Ordenador Portatil 32G 4TB',
            description: 'Ordenador Portatil de 32G y 4TB de almacenamiento<br>Producto en Stock',
            price: 25.00,
            categoryId: 1,
            subcategoryId: 11,
            color: '#3498db',
            svgPath: 'M20,20 L80,20 L80,80 L20,80 Z',
            imgUrl: 'https://raw.githubusercontent.com/onixmannager/Electronics-Components/refs/heads/main/Screenshot_20250311_123905_AliExpress.jpg'
          },
          { 
            id: 2,
            name: 'Pantalón casual',
            description: 'Pantalón cómodo para uso diario',
            price: 35.00,
            categoryId: 1,
            subcategoryId: 12,
            color: '#2ecc71',
            svgPath: 'M30,30 L70,30 L70,70 L30,70 Z',
            imgUrl: 'https://via.placeholder.com/150?text=Pantal%C3%B3n+casual'
          },
          { 
            id: 3,
            name: 'Vestido floral',
            description: 'Vestido ligero con estampado floral',
            price: 45.00,
            categoryId: 2,
            subcategoryId: 21,
            color: '#e74c3c',
            svgPath: 'M25,20 L75,20 L75,80 L25,80 Z',
            imgUrl: 'https://via.placeholder.com/150?text=Vestido+floral'
          },
          { 
            id: 4,
            name: 'Blusa elegante',
            description: 'Blusa de seda, ideal para ocasiones formales',
            price: 30.00,
            categoryId: 2,
            subcategoryId: 22,
            color: '#9b59b6',
            svgPath: 'M30,25 L70,25 L70,75 L30,75 Z',
            imgUrl: 'https://via.placeholder.com/150?text=Blusa+elegante'
          },
          { 
            id: 5,
            name: 'Zapatillas deportivas',
            description: 'Zapatillas cómodas para correr',
            price: 50.00,
            categoryId: 3,
            subcategoryId: 31,
            color: '#f1c40f',
            svgPath: 'M35,30 L65,30 L65,70 L35,70 Z',
            imgUrl: 'https://via.placeholder.com/150?text=Zapatillas+deportivas'
          },
          { 
            id: 6,
            name: 'Zapatos formales',
            description: 'Zapatos de vestir para ocasiones formales',
            price: 60.00,
            categoryId: 3,
            subcategoryId: 32,
            color: '#34495e',
            svgPath: 'M40,35 L60,35 L60,65 L40,65 Z',
            imgUrl: 'https://via.placeholder.com/150?text=Zapatos+formales'
          },
          { 
            id: 7,
            name: 'Bolso de cuero',
            description: 'Bolso elegante en cuero auténtico',
            price: 70.00,
            categoryId: 4,
            subcategoryId: 41,
            color: '#8e44ad',
            svgPath: 'M30,40 L70,40 L70,60 L30,60 Z',
            imgUrl: 'https://via.placeholder.com/150?text=Bolso+de+cuero'
          },
          { 
            id: 8,
            name: 'Sombrero de paja',
            description: 'Sombrero ligero ideal para el verano',
            price: 20.00,
            categoryId: 4,
            subcategoryId: 43,
            color: '#f39c12',
            svgPath: 'M25,35 L75,35 L75,65 L25,65 Z',
            imgUrl: 'https://via.placeholder.com/150?text=Sombrero+de+paja'
          }
        ]);
        // Variables reactivas
        const searchQuery = ref('');
        const selectedCategory = ref(categories.value[0]); // "Inicio" por defecto
        const selectedSubcategory = ref(null);
        const selectedProduct = ref(null);
        const quantity = ref(1);
        const selectedSize = ref('');
        const cartItems = ref([]);
        const isCartOpen = ref(false);
        
        // Computed: Filtrado de productos según categoría, subcategoría y búsqueda
        const filteredProducts = computed(() => {
          if (selectedCategory.value.id === 0) {
            return products.value.filter(product =>
              product.name.toLowerCase().includes(searchQuery.value.toLowerCase()) ||
              product.description.toLowerCase().includes(searchQuery.value.toLowerCase())
            );
          } else {
            let result = products.value.filter(product => product.categoryId === selectedCategory.value.id);
            if (selectedSubcategory.value) {
              result = result.filter(product => product.subcategoryId === selectedSubcategory.value.id);
            }
            if (searchQuery.value) {
              const q = searchQuery.value.toLowerCase();
              result = result.filter(product =>
                product.name.toLowerCase().includes(q) || product.description.toLowerCase().includes(q)
              );
            }
            return result;
          }
        });
        
        const cartSubtotal = computed(() => {
          return cartItems.value.reduce((sum, item) => sum + (item.product.price * item.quantity), 0);
        });
        const cartTax = computed(() => cartSubtotal.value * 0.1);
        const cartTotal = computed(() => cartSubtotal.value + cartTax.value);
        
        // Funciones de selección y navegación
        function selectCategory(category) {
          selectedCategory.value = category;
          selectedSubcategory.value = null;
        }
        function selectSubcategory(sub) {
          selectedSubcategory.value = sub;
        }
        function showProductDetails(product) {
          selectedProduct.value = product;
          quantity.value = 1;
          selectedSize.value = ''; // Reiniciar selección de talla
        }
        function closeModal() {
          selectedProduct.value = null;
        }
        function increaseQuantity() {
          quantity.value++;
        }
        function decreaseQuantity() {
          if (quantity.value > 1) quantity.value--;
        }
        // Función para obtener las tallas disponibles según el producto
        function getSizeOptions(product) {
          if (!product) return [];
          if (product.categoryId === 1 || product.categoryId === 2) { // Ropa
            return ['XS', 'S', 'M', 'L', 'XL'];
          } else if (product.categoryId === 3) { // Calzado
            return [36, 37, 38, 39, 40, 41, 42];
          }
          return [];
        }
        // Función para añadir al carrito comprobando la selección de talla (si es necesario)
        function addToCart() {
          if (getSizeOptions(selectedProduct.value).length > 0 && !selectedSize.value) {
            alert('Por favor, seleccione una talla.');
            return;
          }
          const existingItem = cartItems.value.find(item => 
            item.product.id === selectedProduct.value.id && item.size === selectedSize.value
          );
          if (existingItem) {
            existingItem.quantity += quantity.value;
          } else {
            cartItems.value.push({ product: selectedProduct.value, quantity: quantity.value, size: selectedSize.value });
          }
          closeModal();
          isCartOpen.value = true;
        }
        function removeFromCart(index) {
          cartItems.value.splice(index, 1);
        }
        function toggleCart() {
          isCartOpen.value = !isCartOpen.value;
        }
        // Función checkout actualizada para redirigir a Stripe directamente
        function checkout() {
          isCartOpen.value = false;
          // En un entorno real, crearías una sesión de checkout en el servidor y redirigirías a Stripe.
          // Aquí se utiliza un URL de ejemplo; reemplázalo por el de tu sesión de checkout.
          window.location.href = "https://checkout.stripe.com/pay/your-checkout-session-id";
        }
        function formatPrice(price) {
          return price.toFixed(2) + ' €';
        }
        // Persistir el carrito en el localStorage
        watch(cartItems, newValue => {
          localStorage.setItem('cartItems', JSON.stringify(newValue));
        }, { deep: true });
        const savedCart = localStorage.getItem('cartItems');
        if (savedCart) {
          cartItems.value = JSON.parse(savedCart);
        }
        
        return {
          categories,
          selectedCategory,
          selectedSubcategory,
          products,
          filteredProducts,
          selectedProduct,
          quantity,
          selectedSize,
          cartItems,
          isCartOpen,
          cartSubtotal,
          cartTax,
          cartTotal,
          selectCategory,
          selectSubcategory,
          showProductDetails,
          closeModal,
          increaseQuantity,
          decreaseQuantity,
          addToCart,
          removeFromCart,
          toggleCart,
          checkout,
          formatPrice,
          searchQuery,
          getSizeOptions
        };
      }
    }).mount('#app');
  </script>
</body>
</html>
